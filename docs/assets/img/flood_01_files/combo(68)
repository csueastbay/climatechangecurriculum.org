YUI.add("hermes-template-add-to-stuff-view",function(t,a){var e=t.Template.Handlebars.revive({1:function(t,a,e,n,l){return'\t\t\t\t<li role="button" class="tab-item album-tab selected" data-tab="album" tabindex="0">\n\t\t\t\t\t<span>'+t.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"common.ALBUMS"},data:l}))+"</span>\n\t\t\t\t</li>\n"},3:function(t,a,e,n,l){return'\t\t\t\t<li role="button" class="tab-item gallery-tab" data-tab="gallery" tabindex="0">\n\t\t\t\t\t<span>'+t.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"common.GALLERIES"},data:l}))+"</span>\n\t\t\t\t</li>\n"},5:function(t,a,e,n,l){return'\t\t\t\t<li role="button" class="tab-item group-tab" data-tab="group" tabindex="0">\n\t\t\t\t\t<span>'+t.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"common.GROUPS"},data:l}))+"</span>\n\t\t\t\t</li>\n"},7:function(t,a,e,n,l){var s=null!=a?a:{},i=e.helperMissing,o=t.escapeExpression;return'\t\t\t<div class="tab-container selected" data-tab="album">\n\t\t\t\t'+o((e.outlet||a&&a.outlet||i).call(s,null!=a?a["album-selection-view"]:a,{name:"outlet",hash:{},data:l}))+"\n\t\t\t\t"+o((e.outlet||a&&a.outlet||i).call(s,null!=a?a["album-creation-view"]:a,{name:"outlet",hash:{},data:l}))+"\n\t\t\t</div>\n"},9:function(t,a,e,n,l){var s=null!=a?a:{},i=e.helperMissing,o=t.escapeExpression;return'\t\t\t<div class="tab-container" data-tab="gallery">\n\t\t\t\t'+o((e.outlet||a&&a.outlet||i).call(s,null!=a?a["gallery-selection-view"]:a,{name:"outlet",hash:{},data:l}))+"\n\t\t\t\t"+o((e.outlet||a&&a.outlet||i).call(s,null!=a?a["gallery-creation-view"]:a,{name:"outlet",hash:{},data:l}))+"\n\t\t\t</div>\n"},11:function(t,a,e,n,l){var s,i=null!=a?a:{};return'\t\t\t<div class="tab-container" data-tab="group">\n\t\t\t\t'+t.escapeExpression((e.outlet||a&&a.outlet||e.helperMissing).call(i,null!=a?a["group-selection-view"]:a,{name:"outlet",hash:{},data:l}))+"\n"+(null!=(s=e.if.call(i,null!=a?a.inlineGroupCreation:a,{name:"if",hash:{},fn:t.program(12,l,0),inverse:t.noop,data:l}))?s:"")+"\t\t\t</div>\n"},12:function(t,a,e,n,l){return"\t\t\t\t\t"+t.escapeExpression((e.outlet||a&&a.outlet||e.helperMissing).call(null!=a?a:{},null!=a?a["group-creation-view"]:a,{name:"outlet",hash:{},data:l}))+"\n"},compiler:[7,">= 4.0.0"],main:function(t,a,e,n,l){var s,i=null!=a?a:{};return'<div class="add-to-stuff-container" tabindex="-1">\n\t<div class="nav">\n\t\t<div class="list-label">'+t.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(i,{name:"intlMessage",hash:{intlName:"add-to-stuff.ADD_TO_LABEL"},data:l}))+"</div>\n\t\t<ul>\n"+(null!=(s=e.if.call(i,null!=a?a.showAlbums:a,{name:"if",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l}))?s:"")+(null!=(s=e.if.call(i,null!=a?a.showGalleries:a,{name:"if",hash:{},fn:t.program(3,l,0),inverse:t.noop,data:l}))?s:"")+(null!=(s=e.if.call(i,null!=a?a.showGroups:a,{name:"if",hash:{},fn:t.program(5,l,0),inverse:t.noop,data:l}))?s:"")+'\t\t</ul>\n\t\t<svg class="close-x-button"><use xlink:href="#icon-close"></use></svg>\n\t</div>\n\t<div class="tab-content-container">\n\n'+(null!=(s=e.if.call(i,null!=a?a.showAlbums:a,{name:"if",hash:{},fn:t.program(7,l,0),inverse:t.noop,data:l}))?s:"")+"\n"+(null!=(s=e.if.call(i,null!=a?a.showGalleries:a,{name:"if",hash:{},fn:t.program(9,l,0),inverse:t.noop,data:l}))?s:"")+"\n"+(null!=(s=e.if.call(i,null!=a?a.showGroups:a,{name:"if",hash:{},fn:t.program(11,l,0),inverse:t.noop,data:l}))?s:"")+"\t</div>\n</div>\n"},useData:!0}),n={};t.Array.each([],function(a){var e=t.Template.get("hermes/"+a);e&&(n[a]=e)}),t.Template.register("hermes/add-to-stuff-view",function(a,l){return l=l||{},l.partials=l.partials?t.merge(n,l.partials):n,e(a,l)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("add-to-stuff-view",function(e){e.namespace("Views")[this.name]=e.Base.create("add-to-stuff-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.params=e,this.params.showAlbums=!1!==this.params.showAlbums,this.params.showGalleries=!1!==this.params.showGalleries,this.params.showGroups=!1!==this.params.showGroups,this.params.initialTab=this.params.initialTab||"album",this.initialTab=this.params.initialTab,this.params.inlineGroupCreation=this.params.inlineGroupCreation||!1,this.params.inlineAlbumCreation=void 0===this.params.inlineAlbumCreation||this.params.inlineAlbumCreation,this.params.inlineGalleryCreation=void 0===this.params.inlineGalleryCreation||this.params.inlineGalleryCreation,this.params.inlineCreation={album:this.params.inlineAlbumCreation,gallery:this.params.inlineGalleryCreation,group:this.params.inlineGroupCreation},this.currentTabName="",this},subviewConfig:{"album-selection-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,additionalViewClasses:["stuff-selection-view"]},"gallery-selection-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,additionalViewClasses:["stuff-selection-view"]},"group-selection-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,additionalViewClasses:["stuff-selection-view"]},"album-creation-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,additionalViewClasses:["stuff-creation-view","hidden"]},"gallery-creation-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,additionalViewClasses:["stuff-creation-view","hidden"]},"group-creation-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,additionalViewClasses:["stuff-creation-view","hidden"]}},buildContainer:function(){return this.setContainerWithTemplate("add-to-stuff-view",{showAlbums:this.params.showAlbums,showGalleries:this.params.showGalleries,showGroups:this.params.showGroups,inlineGroupCreation:this.params.inlineGroupCreation}),this},activate:function(){var e=this,t=this.get("container");return this.nav=t.one(".nav"),this.firstTab=t.one(".tab-item"),["album","gallery","group"].forEach(function(t){e.subviews[t+"-selection-view"].on("showCreate",function(){e.showCreate(t)}),e.setupCreationEvents(e.subviews[t+"-creation-view"])}),this.registerEventHandler(this.nav.one("ul").on(["click","key"],this.handleNavClick.bind(this),"down:13")),this.registerEventHandler(this.nav.one(".close-x-button").on("click",this.handleCloseClick.bind(this))),this.switchTabs(this.initialTab),this.registerEventHandler(t.on("keydown",this.handleKeyPress.bind(this))),this.registerEventHandler(t.delegate("focus",this.handleFocus.bind(this))),this},showCreate:function(e){this.params.inlineCreation[e]?(this.subviews[e+"-selection-view"].get("container").addClass("hidden"),this.subviews[e+"-creation-view"].get("container").removeClass("hidden"),this.nav.hide(),this.subviews[e+"-creation-view"].focusInitial(),this.fire("contentSizeChanged")):this.showCreateModal(e)},showCreateModal:function(t){var i=new e.CurationHelper(this.appContext,{this:this});i.showCreationModal({viewName:t+"-creation-view",overlayClassList:"over-droparound-under-modal",customConfig:{photoId:this.params.photoId,inlineCreation:this.params.inlineCreation[t]}}),this.setupCreationEvents(i.creationView)},setupCreationEvents:function(e){var t=this,i=e.curationType;e.on("cancel",function(){t.params.inlineCreation[i]&&t.hideCreate(i)}),e.on("readyToClose",function(){t.params.inlineCreation[i]&&t.fire("readyToClose")}),e.on("created",function(e){t.params.inlineCreation[i]&&t.hideCreate(i),t.params.dismissOnCreate?t.fire("readyToClose"):e.curation&&t.subviews[i+"-selection-view"].reload()}),e.on("contentSizeChanged",function(e){t.fire("contentSizeChanged")})},hideCreate:function(e){this.subviews[e+"-selection-view"].get("container").removeClass("hidden"),this.subviews[e+"-creation-view"].get("container").addClass("hidden"),this.nav.show(),this.subviews[e+"-selection-view"].focusInitial(),this.fire("contentSizeChanged")},handleNavClick:function(e){var t;e.stopPropagation(),e.preventDefault(),e.target&&(t=e.target.ancestor("li",!0))&&this.switchTabs(t.get("dataset").tab)},switchTabs:function(e){var t=this,i=this.nav.one(".tab-item.selected"),n=this.nav.one(".tab-item[data-tab="+e+"]"),a=i?i.get("dataset").tab:null,r=this.get("container").one(".tab-content-container"),s=r.one(".tab-container[data-tab="+a+"]"),o=r.one(".tab-container[data-tab="+e+"]"),l=o.one(".stuff-selection-search");this.currentTabName=e,i&&(i.removeClass("selected"),s.removeClass("selected")),n.addClass("selected"),o.addClass("selected"),setTimeout(function(){t.fire("contentSizeChanged")},0),setTimeout(function(){l.focus()},10)},handleCloseClick:function(e){this.fire("readyToClose")},handleKeyPress:function(t){var i=t.keyCode,n=t.shiftKey,a=this.get("container").one(".tab-container.selected"),r=a.one(".done-button")||a.one(".create-button");9===i&&(n&&this.focusedItem===this.firstTab?(t.preventDefault(),r.focus()):n||this.focusedItem!==r||(t.preventDefault(),this.firstTab.focus())),e.fire("addToStuff:keyPressed",{curationType:this.currentTabName,evt:t})},handleFocus:function(e){this.focusedItem=e.target},onSubviewEvent:function(e,t){"readyToClose"===t[0].eventName&&this.fire("readyToClose")}},{ATTRS:{dismissOnCreate:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnCreateAlbum:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnCreateGallery:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnCreateGroup:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnSelect:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnSelectAlbum:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnSelectGallery:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnSelectGroup:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}},inlineGroupCreation:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}},useLargeLayout:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,i){return e.AttributeHelpers.coerceBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-add-to-stuff-view"],langBundles:["common","more-menu-view","add-to-stuff"]});YUI.add("hermes-lang-more-menu-view",function(e,o){e.Intl.add("hermes/more-menu-view","en-US",{ADD_TO_ALBUM:["Add to album"],ADD_TO_SET:["Add to set"],ADD_TO_GROUP:["Add to group"],INVITE_TO_GROUP:["Invite to group"],ADD_TO_GALLERY:["Add to Gallery"],ADD_TO_REMOVE_FROM_ALBUM:["Add to / remove from album"],ADD_TO_REMOVE_FROM_SET:["Add to / remove from set"],ADD_TO_REMOVE_FROM_GALLERY:["Add to / remove from gallery"],ADD_TO_REMOVE_FROM_GROUP:["Add to / remove from group"],INVITE_TO_REMOVE_FROM_GROUP:["Invite to / remove from group"],FLAG_PHOTO:["Flag this Photo?"],FLAG:["Flag photo"],MARK_FOR_REVIEW:["Mark for review"],PHOTO_HAS_BEEN_FLAGGED:["This photo has been flagged"],PROBLEM_FLAGGING:["There was a problem flagging this photo"],ADD_PHOTO_TO_GROUP:["Add this photo to a group"],INVITE_PHOTO_TO_GROUP:["Invite this photo to a group"],ADD_PHOTO_TO_GALLERY:["Add this photo to a gallery"],ADD_PHOTO_TO_ALBUM:["Add photo to an album"],ADD_PHOTO_TO_SET:["Add photo to a set"],NO_GROUPS:["You're not in any groups! <a href='//www.flickr.com/groups'>Why not join one</a>?"],NO_GROUPS2:["You're not in any groups! <a href='","${url}","'>Why not join one</a>?"],NO_GROUPS_ADMIN:["You're not an admin of any groups! <a href='//www.flickr.com/groups_create.gne'>Why not create one</a>?"],NO_GROUPS_ADMIN2:["You're not an admin of any groups! <a href='","${url}","'>Why not create one</a>?"],NO_GALLERIES:["No galleries"],NO_ALBUMS:["No albums"],NO_SETS:["No sets"],LOADING_GROUPS:["Loading groups..."],LOADING_GALLERIES:["Loading galleries..."],LOADING_ALBUMS:["Loading albums..."],LOADING_SETS:["Loading sets..."],SEARCH_GROUPS_PLACEHOLDER:["search groups"],SEARCH_GALLERIES_PLACEHOLDER:["search galleries"],SEARCH_ALBUMS_PLACEHOLDER:["search albums"],SEARCH_SETS_PLACEHOLDER:["search sets"],GALLERY_TITLE_PLACEHOLDER:["gallery title (required)"],GALLERY_DESCRIPTION_PLACEHOLDER:["gallery description"],ALBUM_TITLE_PLACEHOLDER:["Album title"],SET_TITLE_PLACEHOLDER:["Set title"],DESCRIPTION_PLACEHOLDER:["Description (optional)"],CREATE_NEW_GALLERY:["Create a new gallery"],CREATE_NEW_ALBUM:["Create new album"],CREATE_NEW_SET:["Create new set"],CREATE_GALLERY:["Create gallery"],CREATE_SET:["Create set"],CREATE_ALBUM:["Create album"],BACK_TO_GALLERIES:["Back to current galleries"],BACK_TO_ALBUMS:["Back to current albums"],BACK_TO_SETS:["Back to current sets"],GROUP_PRIVACY_WARNING:["This photo is private. If you add it to a group, the members of that group will be able to view, comment on, tag and add notes to it."],DONT_SHOW_ME_AGAIN:["Don't show me this message again"],DELETE_PHOTO:["Delete Photo"],PERMANENTLY_DELETE_PHOTO:["Permanently Delete This Photo"],PROBLEM_DELETING:["There was a problem deleting this photo"],ADD_LOCATION:["Add Location"],ADD_PEOPLE:["Add people"],DOWNLOAD_ALL_SIZES:["Download / All sizes"],EDIT_DATES:["Edit dates"],EDIT_TITLE_TAGS_DATES:["Edit title, tags, and dates"],ROTATE:["Rotate"],REPLACE:["Replace"],VIDEOS_NO_EDIT_IN_AVIARY:["Videos cannot be edited in Aviary"],EDIT_IN_AVIARY:["Edit in Aviary"],COMMENTING:["Commenting"],REPORT_ABUSE:["Report abuse"],FEEDBACK:["Feedback"],PEOPLE_TAGGING:["People tagging!"],OPEN_IN_ORGANIZER:["Open In Organizr"],MORE_ACTIONS:["More Actions"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-add-to-stuff",function(e,o){e.Intl.add("hermes/add-to-stuff","en-US",{ADD_TO_LABEL:["Add to:"],NO_RESULTS:["No results :("],NO_GROUPS:["No groups"],DONT_ADMIN_ANY_GROUPS:["You don’t admin any groups."],LEARN_TO_RUN_GROUP:["Learn how to run a group"],HAVENT_JOINED_ANY_GROUPS:["You haven’t joined any groups."],DISCOVER_GROUPS:["Discover groups"],PENDING_APPROVAL:["Pending approval"],CURATIONS_CREATE_NEW_GROUP:["Create new group"],CURATIONS_CREATE_A_NEW_GROUP:["Create a new group"],CURATIONS_CREATE_NEW_ALBUM:["Create new album"],CURATIONS_CREATE_A_NEW_ALBUM:["Create a new album"],CURATIONS_CREATE_NEW_GALLERY:["Create new gallery"],CURATIONS_CREATE_A_NEW_GALLERY:["Create a new gallery"],ABOUT_YOUR_GROUP:["About your group"],COULDNT_ADD_TO_GROUP:["Couldn’t add to group."],COULDNT_ACCEPT_GROUP_INVITE:["Couldn’t accept invitation to group."],COULDNT_INVITE_TO_GROUP:["Couldn’t invite to group."],COULDNT_CANCEL_GROUP_INVITE:["Couldn’t cancel group invitation."],COULDNT_REMOVE_FROM_GROUP:["Couldn’t remove from group"],APPROVE:["Approve"],CURATIONS_ALBUM_NAME:["Album name"],CURATIONS_GALLERY_NAME:["Gallery name"],CURATIONS_DESCRIPTION_OPTIONAL:["Description (optional)"],PLEASE_ENTER_GROUP_NAME:["Please enter a group name."],PLEASE_ENTER_ALBUM_NAME:["Please enter an album name."],PLEASE_ENTER_GALLERY_NAME:["Please enter a gallery name."],COULDNT_SAVE_GROUP:["Couldn’t save group. Please try again."],COULDNT_SAVE_ALBUM:["Couldn’t save album. Please try again."],COULDNT_SAVE_GALLERY:["Couldn’t save gallery. Please try again."],GROUP_PRIVATE_PHOTO_WARNING:["This photo is private. If you add it to a group, the members of that group will be able to view, comment on, tag, and add notes to it."],CONFIRM_GROUP_PRIVATE_PHOTO_ADD:["Ok, add to groups anyway"],DONT_SHOW_MESSAGE_AGAIN:["Don’t show me this message again"],COULDNT_ADD_TO_GROUP_TOO_MANY:["Photo in maximum number of groups"],COULDNT_ADD_TO_GROUP_TOO_MANY_NON_PRO:["Photo in maximum number of groups for non-pro account"],YOU_ALREADY_ADDED_MAXIMUM_TO_GROUP:["You have already added the maximum number of photos to this group"],COULDNT_ADD_PHOTO:["Oh no! We couldn’t add the ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],ONLY_PUBLIC_PHOTOS_ALLOWED:["Oops! Only public ",{type:"select",valueName:"mediaType",options:{photo:["photos"],video:["videos"],other:["photos"]}}," are allowed."],GALLERY_FULL:["Oops! This gallery is full."],ONLY_SAFE_PHOTOS_ALLOWED:["Uh oh! Only ",{type:"select",valueName:"mediaType",options:{photo:["photos"],video:["videos"],other:["photos"]}}," marked “Safe” are allowed."],YOUVE_BEEN_BLOCKED:["You’ve been blocked by the photo owner."],OWNER_DOESNT_ALLOW_IN_GALLERIES:["Oh no! The ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}," owner doesn’t allow their stuff in galleries."]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-stuff-creation-view",function(e,t){var a=e.Template.Handlebars.revive({1:function(e,t,a,n,l){return"large"},3:function(e,t,a,n,l){return'<div class="error-message create-error hidden"></div>'},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,l){var i,r,s=null!=t?t:{},c=a.helperMissing,o="function",u=e.escapeExpression;return'<div class="stuff-creation-container '+(null!=(i=a.if.call(s,null!=t?t.isLarge:t,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l}))?i:"")+'">\n\t<header>\n\t\t<h1 class="stuff-creation-heading">'+u(typeof(r=null!=(r=a.heading||(null!=t?t.heading:t))?r:c)===o?r.call(s,{name:"heading",hash:{},data:l}):r)+'</h1>\n\t\t<svg class="close-x-button"><use xlink:href="#icon-close"></use></svg>\n\t</header>\n\t<div class="input-item title-input-item">\n\t\t<input class="input-field stuff-creation-title" type="text" placeholder="'+u(typeof(r=null!=(r=a.placeholderTitle||(null!=t?t.placeholderTitle:t))?r:c)===o?r.call(s,{name:"placeholderTitle",hash:{},data:l}):r)+'">\n\t\t<div class="error-message title-error"></div>\n\t</div>\n\t<textarea class="input-field stuff-creation-description" placeholder="'+u(typeof(r=null!=(r=a.placeholderDescription||(null!=t?t.placeholderDescription:t))?r:c)===o?r.call(s,{name:"placeholderDescription",hash:{},data:l}):r)+'"></textarea>\n\t<div class="create-footer">\n\t\t'+(null!=(i=a.if.call(s,null!=t?t.isLarge:t,{name:"if",hash:{},fn:e.noop,inverse:e.program(3,l,0),data:l}))?i:"")+'\n\t\t<div class="buttons">\n\t\t\t'+(null!=(i=a.if.call(s,null!=t?t.isLarge:t,{name:"if",hash:{},fn:e.program(3,l,0),inverse:e.noop,data:l}))?i:"")+'\n\t\t\t<button class="alt button mini button-cancel">'+u(typeof(r=null!=(r=a.cancelText||(null!=t?t.cancelText:t))?r:c)===o?r.call(s,{name:"cancelText",hash:{},data:l}):r)+'</button>\n\t\t\t<button class="button mini button-action">'+u(typeof(r=null!=(r=a.actionText||(null!=t?t.actionText:t))?r:c)===o?r.call(s,{name:"actionText",hash:{},data:l}):r)+"</button>\n\t\t</div>\n\t</div>\n</div>\n"},useData:!0}),n={};e.Array.each([],function(t){var a=e.Template.get("hermes/"+t);a&&(n[t]=a)}),e.Template.register("hermes/stuff-creation-view",function(t,l){return l=l||{},l.partials=l.partials?e.merge(n,l.partials):n,a(t,l)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("stuff-creation-view",function(t,e){t.namespace("Views")[this.name]=t.Base.create("stuff-creation-view",t.FlickrView,[],{initializer:function(t){return this.params=t,this.heading=t.heading,this.placeholderTitle=t.placeholderTitle,this.placeholderDescription=t.placeholderDescription,this.cancelText=t.cancelText,this.actionText=t.actionText,this.inlineCreation=t.inlineCreation,this},buildContainer:function(){return this.setContainerWithTemplate("stuff-creation-view",{heading:this.heading,placeholderTitle:this.placeholderTitle,placeholderDescription:this.placeholderDescription,cancelText:this.cancelText,actionText:this.actionText,isLarge:this.params.useLargeLayout}),this},activate:function(){return this.isCreating=!1,this},showError:function(t,e,i){i&&t.set("text",i),e?t.removeClass("hidden"):t.addClass("hidden")},showTitleError:function(t,e){this.titleItemNode.toggleClass("error",t),e&&this.titleErrorNode.set("text",e)},destructor:function(){this.closeTimer&&clearTimeout(this.closeTimer)},resetView:function(){this.buildContainer(),this.activate()},createCuration:function(){var e=this;return this.isCreating?t.Promise.reject():(this.isCreating=!0,this.actionButton.setAttribute("disabled"),this.createNewAndAddPhoto().then(function(t){return e.isCreating=!1,e.actionButton.removeAttribute("disabled"),t}).catch(function(t){throw e.isCreating=!1,e.actionButton.removeAttribute("disabled"),t}))},focusInitial:function(){}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-stuff-creation-view"]});YUI.add("album-creation-view",function(e,t){var i=require("hermes-core/flog")(t);e.namespace("Views")[this.name]=e.Base.create("album-creation-view",e.Views["stuff-creation-view"],[],{langBundles:this.details.langBundles,initializer:function(e){return e.heading=this.intlMessage({intlName:"add-to-stuff.CURATIONS_CREATE_A_NEW_ALBUM"}),e.placeholderTitle=this.intlMessage({intlName:"add-to-stuff.CURATIONS_ALBUM_NAME"}),e.placeholderDescription=this.intlMessage({intlName:"add-to-stuff.CURATIONS_DESCRIPTION_OPTIONAL"}),e.cancelText=this.intlMessage({intlName:"common.CANCEL"}),e.actionText=this.intlMessage({intlName:"global-nav.CREATE"}),this.photoId=e.photoId,this.dismissOnCreate=e.dismissOnCreateAlbum,this.curationType="album",this.photoIds=e.photoIds,this.titleError=this.intlMessage({intlName:"add-to-stuff.PLEASE_ENTER_ALBUM_NAME"}),this.createError=this.intlMessage({intlName:"add-to-stuff.COULDNT_SAVE_ALBUM"}),this.constructor.superclass.initializer.call(this,e)},activate:function(){var e=this.get("container");this.titleItemNode=e.one(".input-item.title-input-item"),this.titleErrorNode=e.one(".error-message.title-error"),this.createErrorNode=e.one(".error-message.create-error"),this.titleNode=e.one(".stuff-creation-title"),this.descriptionNode=e.one(".stuff-creation-description"),this.cancelButton=e.one(".button-cancel"),this.actionButton=e.one(".button-action"),this.closeButton=e.one(".close-x-button"),this.setupEvents(),this.constructor.superclass.activate.call(this,this.params)},setupEvents:function(){var e=this;this.get("container");this.registerEventHandler(this.titleNode.on("keyup",function(){e.titleNode.get("value")&&e.showTitleError(!1)})),this.registerEventHandler(this.cancelButton.on("click",function(){e.fire("cancel"),e.resetView()})),this.registerEventHandler(this.closeButton.on("click",function(){e.fire("readyToClose")})),this.registerEventHandler(this.actionButton.on("click",function(){e.createCuration()}))},createNewAndAddPhoto:function(){var t,o=this,s=!!this.photoIds,n=this.titleNode.get("value"),r=this.descriptionNode.get("value");return n?(t={photoID:s?this.photoIds[0]:this.photoId,title:n,description:r,isMultiplePhotos:s,numberOfPhotosSelected:o.params.numberOfPhotosSelected,numberOfVideosSelected:o.params.numberOfVideosSelected},this.appContext.getModelRegistry("set-models").then(function(e){return o.albumsModel=e,e.remote.create(t,o.appContext)}).then(function(e){return s&&o.photoIds.slice(1).length>0?o.addPhotos(e.getValue("id"),o.photoIds).then(function(){return e}):e}).then(function(e){return o.titleNode.set("value",""),o.descriptionNode.set("value",""),o.fire("created",{type:o.curationType,curation:e}),o.params.inlineCreation?o.resetView():o.fire("readyToClose"),e}).catch(function(e){throw i.error("Error handling photo addition after album creation",{err:e}),e})):(o.showTitleError(!0,o.titleError),e.Promise.reject({message:o.titleError}))},addPhotos:function(t,i){for(var o=this,s=[],n=[],r=0;r<i.length;r+=500)s.push(i.slice(r,r+500<i.length?r+500:i.length));return s.forEach(function(e,i){n.push(o.albumsModel.remote.addPhoto({photoID:e.join(","),isMultiplePhotos:!0,photosSelectedIds:o.params.photosSelectedIds,videosSelectedIds:o.params.videosSelectedIds,numberOfPhotosSelected:o.params.numberOfPhotosSelected,numberOfVideosSelected:o.params.numberOfVideosSelected,setID:t,updateItemCounts:0===i},this.appContext))}),e.Promise.all(n).then(function(e){return e&&e[0]?e[0].setModel:null})},focusInitial:function(){this.titleNode&&this.titleNode.focus()}})},"@VERSION@",{requires:["flickr-view","stuff-creation-view"],optional:["set-models"],langBundles:["more-menu-view","common","global-nav","add-to-stuff"]});YUI.add("gallery-creation-view",function(e,t){var i=require("hermes-core/flog")(t);e.namespace("Views")[this.name]=e.Base.create("gallery-creation-view",e.Views["stuff-creation-view"],[],{langBundles:this.details.langBundles,initializer:function(e){return e.heading=this.intlMessage({intlName:"add-to-stuff.CURATIONS_CREATE_A_NEW_GALLERY"}),e.placeholderTitle=this.intlMessage({intlName:"add-to-stuff.CURATIONS_GALLERY_NAME"}),e.placeholderDescription=this.intlMessage({intlName:"add-to-stuff.CURATIONS_DESCRIPTION_OPTIONAL"}),e.cancelText=this.intlMessage({intlName:"common.CANCEL"}),e.actionText=this.intlMessage({intlName:"global-nav.CREATE"}),this.photoId=e.photoId,this.dismissOnCreate=e.dismissOnCreateGallery,this.curationType="gallery",this.titleError=this.intlMessage({intlName:"add-to-stuff.PLEASE_ENTER_GALLERY_NAME"}),this.createError=this.intlMessage({intlName:"add-to-stuff.COULDNT_SAVE_GALLERY"}),this.constructor.superclass.initializer.call(this,e)},activate:function(){var e=this.get("container");this.titleItemNode=e.one(".input-item.title-input-item"),this.titleErrorNode=e.one(".error-message.title-error"),this.createErrorNode=e.one(".error-message.create-error"),this.titleNode=e.one(".stuff-creation-title"),this.descriptionNode=e.one(".stuff-creation-description"),this.actionButton=e.one(".button-action"),this.setupEvents(),this.constructor.superclass.activate.call(this,this.params)},setupEvents:function(){var e=this,t=this.get("container");this.cancelButton=t.one(".button-cancel"),this.actionButton=t.one(".button-action"),this.closeButton=t.one(".close-x-button"),this.registerEventHandler(this.titleNode.on("keyup",function(){e.titleNode.get("value")&&e.showTitleError(!1)})),this.registerEventHandler(this.cancelButton.on("click",function(){e.fire("cancel"),e.resetView()})),this.registerEventHandler(this.closeButton.on("click",function(){e.fire("readyToClose")})),this.registerEventHandler(this.actionButton.on("click",function(){e.createCuration()}))},createNewAndAddPhoto:function(){var t,r=this,o=this.titleNode.get("value"),n=this.descriptionNode.get("value");return e.rapidTracker.beacon(r.name,"galleryCreationViewCreateClick"),o?(r.showError(r.createErrorNode,!1),t={photoID:r.photoId,title:o,description:n},this.appContext.getModelRegistry("gallery-models").then(function(e){return e.remote.create(t,r.appContext)}).then(function(e){return r.photoId&&!e.getValue("primary")&&i.error("Photo cannot be added to galleries."),r.titleNode.set("value",""),r.descriptionNode.set("value",""),r.fire("created",{type:r.curationType,curation:e}),r.params.inlineCreation?r.resetView():r.fire("readyToClose"),e}).catch(function(e){throw i.error("Error handling photo addition after gallery creation",{err:e}),r.showError(r.createErrorNode,!0,r.createError),e})):(r.showTitleError(!0,r.titleError),e.Promise.reject({message:r.titleError}))},focusInitial:function(){this.titleNode&&this.titleNode.focus()}})},"@VERSION@",{requires:["flickr-view","stuff-creation-view"],langBundles:["more-menu-view","common","global-nav","add-to-stuff"]});